# Usual compilation flags
CFLAGS   = -Wall -Wextra -O3 -std=c11 -msse -msse2 -maes -DNDEBUG
CPPFLAGS = -I../include -I../src
LDFLAGS  =

TESTS = aes128_tests aes192_tests aes256_tests aes-bruteforce_tests

all: $(TESTS)

aes128_tests: aes128_tests.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -o $@ $^

aes192_tests: aes192_tests.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -o $@ $^

aes256_tests: aes256_tests.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -o $@ $^

aes-bruteforce_tests: aes-bruteforce_tests.c
	$(CC) $(CFLAGS) $(CPPFLAGS) -fopenmp -o $@ $^

check: $(TESTS)
	@for exec in $^; do ./$$exec; done

clean:
	rm -f *~ *.o $(TESTS)

help:
	@echo "Usage:"
	@echo "  make\t\tBuild the tests"
	@echo "  make check\t\tRun all the tests"
	@echo "  make clean\tRemove all files generated by make"
	@echo "  make help\tDisplay this help"
